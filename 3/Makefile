#####################################
# Module: SYSPROG WS 2010 TU Wien   #
# Author: Jakob Gruber ( 0203440 )  #
# Date:   2010-11-19                #
#####################################

GCC=gcc
CFLAGS=-ansi -pedantic -Wall -c -D_XOPEN_SOURCE=500
LDFLAGS=-lsem182
TAR=tar
TARFLAGS=-cvz
SOURCESCOMMON=util.c
SOURCESSERVER=server.c
SOURCESCLIENT=client.c
SOURCES=$(SOURCESCOMMON) $(SOURCESSERVER) $(SOURCESCLIENT)
OBJECTSCOMMON=$(SOURCESCOMMON:.c=.o)
OBJECTSSERVER=$(SOURCESSERVER:.c=.o)
OBJECTSCLIENT=$(SOURCESCLIENT:.c=.o)
OBJECTS=$(OBJECTSCOMMON) $(OBJECTSSERVER) $(OBJECTSCLIENT)
TARGETCOMMON=ttt
TARGETSERVER=ttt-server
TARGETCLIENT=ttt-client
TARGETS=$(TARGETSERVER) $(TARGETCLIENT)

all: $(TARGETS)

$(TARGETSERVER): $(OBJECTSSERVER) $(OBJECTSCOMMON)
	$(GCC) $(LDFLAGS) $(OBJECTSSERVER) $(OBJECTSCOMMON) -o $@

$(TARGETCLIENT): $(OBJECTSCLIENT) $(OBJECTSCOMMON)
	$(GCC) $(LDFLAGS) $(OBJECTSCLIENT) $(OBJECTSCOMMON) -o $@

%.o: %.c
	$(GCC) $(CFLAGS) $< -o $@

archive:
	$(TAR) $(TARFLAGS) -f $(TARGETCOMMON).tgz $(SOURCES) *.h Makefile

clean:
	rm -f $(TARGETS) $(OBJECTS)
